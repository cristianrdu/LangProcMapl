.data
  ACC            : 1
  FP             : 3
  MEMHI          : 7
  MEMLO          : 6
  OUT            : 2
  PC             : 0
  RET            : 4
  RV             : 8
  SP             : 5
  tmp.l          : 10
  tmp.t          : 9

  _malloc.errmsg : "_malloc: cannot allocate negative memory!
"

.text
    0:                  LOADI  $ACC, 1
    6:                  SUB    $SP, $ACC
    9:                  MOVE   $SP, $ACC
   12:                  STORE  $tmp.t, ($SP)
   15:                  LOADI  $ACC, 1
   21:                  SUB    $SP, $ACC
   24:                  MOVE   $SP, $ACC
   27:                  STORE  $tmp.l, ($SP)
   30:                  LOADI  $ACC, main
   36:                  JMPAL  $ACC
   38:                  LOAD   $tmp.l, ($SP)
   41:                  LOADI  $ACC, 1
   47:                  ADD    $SP, $ACC
   50:                  MOVE   $SP, $ACC
   53:                  LOAD   $tmp.t, ($SP)
   56:                  LOADI  $ACC, 1
   62:                  ADD    $SP, $ACC
   65:                  MOVE   $SP, $ACC
   68:                  MOVE   $ACC, $RV
   71:                  JMPI   _END
   76:            main: LOADI  $ACC, 1
   82:                  SUB    $SP, $ACC
   85:                  MOVE   $SP, $ACC
   88:                  STORE  $RET, ($SP)
   91:                  LOADI  $ACC, 1
   97:                  SUB    $SP, $ACC
  100:                  MOVE   $SP, $ACC
  103:                  STORE  $FP, ($SP)
  106:                  MOVE   $FP, $SP
  109:                  LOADI  $ACC, 2
  115:                  SUB    $SP, $ACC
  118:                  MOVE   $SP, $ACC
  121:                  MOVE   $ACC, $FP
  124:                  MOVE   $11, $ACC
  127:                  LOADI  $ACC, -1
  133:                  ADD    $11, $ACC
  136:                  MOVE   $11, $ACC
  139:                  LOADI  $ACC, 3
  145:                  MOVE   $tmp.t, $ACC
  148:                  LOADI  $ACC, 1
  154:                  SUB    $SP, $ACC
  157:                  MOVE   $SP, $ACC
  160:                  STORE  $tmp.t, ($SP)
  163:                  LOADI  $ACC, 1
  169:                  SUB    $SP, $ACC
  172:                  MOVE   $SP, $ACC
  175:                  STORE  $tmp.l, ($SP)
  178:                  LOADI  $ACC, 1
  184:                  SUB    $SP, $ACC
  187:                  MOVE   $SP, $ACC
  190:                  STORE  $11, ($SP)
  193:                  MOVE   $ACC, $tmp.t
  196:                  MOVE   $11, $ACC
  199:                  LOADI  $ACC, 1
  205:                  ADD    $11, $ACC
  208:                  MOVE   $11, $ACC
  211:                  LOADI  $ACC, 1
  217:                  SUB    $SP, $ACC
  220:                  MOVE   $SP, $ACC
  223:                  STORE  $11, ($SP)
  226:                  LOADI  $ACC, _malloc
  232:                  JMPAL  $ACC
  234:                  LOAD   $11, ($SP)
  237:                  LOADI  $ACC, 1
  243:                  ADD    $SP, $ACC
  246:                  MOVE   $SP, $ACC
  249:                  LOAD   $tmp.l, ($SP)
  252:                  LOADI  $ACC, 1
  258:                  ADD    $SP, $ACC
  261:                  MOVE   $SP, $ACC
  264:                  LOAD   $tmp.t, ($SP)
  267:                  LOADI  $ACC, 1
  273:                  ADD    $SP, $ACC
  276:                  MOVE   $SP, $ACC
  279:                  MOVE   $ACC, $RV
  282:                  MOVE   $tmp.l, $ACC
  285:                  MOVE   $ACC, $tmp.l
  288:                  MOVE   $12, $ACC
  291:                  LOADI  $ACC, 1
  297:                  SUB    $12, $ACC
  300:                  MOVE   $12, $ACC
  303:                  MOVE   $ACC, $tmp.t
  306:                  STORE  $ACC, ($12)
  309:                  MOVE   $ACC, $tmp.l
  312:                  STORE  $ACC, ($11)
  315:                  MOVE   $ACC, $FP
  318:                  MOVE   $11, $ACC
  321:                  LOADI  $ACC, -2
  327:                  ADD    $11, $ACC
  330:                  MOVE   $11, $ACC
  333:                  LOADI  $ACC, 2
  339:                  MOVE   $tmp.t, $ACC
  342:                  LOADI  $ACC, 1
  348:                  SUB    $SP, $ACC
  351:                  MOVE   $SP, $ACC
  354:                  STORE  $tmp.t, ($SP)
  357:                  LOADI  $ACC, 1
  363:                  SUB    $SP, $ACC
  366:                  MOVE   $SP, $ACC
  369:                  STORE  $tmp.l, ($SP)
  372:                  LOADI  $ACC, 1
  378:                  SUB    $SP, $ACC
  381:                  MOVE   $SP, $ACC
  384:                  STORE  $11, ($SP)
  387:                  MOVE   $ACC, $tmp.t
  390:                  MOVE   $11, $ACC
  393:                  LOADI  $ACC, 1
  399:                  ADD    $11, $ACC
  402:                  MOVE   $11, $ACC
  405:                  LOADI  $ACC, 1
  411:                  SUB    $SP, $ACC
  414:                  MOVE   $SP, $ACC
  417:                  STORE  $11, ($SP)
  420:                  LOADI  $ACC, _malloc
  426:                  JMPAL  $ACC
  428:                  LOAD   $11, ($SP)
  431:                  LOADI  $ACC, 1
  437:                  ADD    $SP, $ACC
  440:                  MOVE   $SP, $ACC
  443:                  LOAD   $tmp.l, ($SP)
  446:                  LOADI  $ACC, 1
  452:                  ADD    $SP, $ACC
  455:                  MOVE   $SP, $ACC
  458:                  LOAD   $tmp.t, ($SP)
  461:                  LOADI  $ACC, 1
  467:                  ADD    $SP, $ACC
  470:                  MOVE   $SP, $ACC
  473:                  MOVE   $ACC, $RV
  476:                  MOVE   $tmp.l, $ACC
  479:                  MOVE   $ACC, $tmp.l
  482:                  MOVE   $12, $ACC
  485:                  LOADI  $ACC, 1
  491:                  SUB    $12, $ACC
  494:                  MOVE   $12, $ACC
  497:                  MOVE   $ACC, $tmp.t
  500:                  STORE  $ACC, ($12)
  503:                  MOVE   $ACC, $tmp.l
  506:                  STORE  $ACC, ($11)
  509:                  MOVE   $ACC, $FP
  512:                  MOVE   $11, $ACC
  515:                  LOADI  $ACC, -1
  521:                  ADD    $11, $ACC
  524:                  LOAD   $ACC, ($ACC)
  527:                  MOVE   $11, $ACC
  530:                  LOADI  $ACC, 0
  536:                  ADD    $11, $ACC
  539:                  MOVE   $11, $ACC
  542:                  LOADI  $ACC, 90
  548:                  STORE  $ACC, ($11)
  551:                  MOVE   $ACC, $FP
  554:                  MOVE   $11, $ACC
  557:                  LOADI  $ACC, -1
  563:                  ADD    $11, $ACC
  566:                  LOAD   $ACC, ($ACC)
  569:                  MOVE   $11, $ACC
  572:                  LOADI  $ACC, 1
  578:                  ADD    $11, $ACC
  581:                  MOVE   $11, $ACC
  584:                  LOADI  $ACC, 91
  590:                  STORE  $ACC, ($11)
  593:                  MOVE   $ACC, $FP
  596:                  MOVE   $11, $ACC
  599:                  LOADI  $ACC, -1
  605:                  ADD    $11, $ACC
  608:                  LOAD   $ACC, ($ACC)
  611:                  MOVE   $11, $ACC
  614:                  LOADI  $ACC, 2
  620:                  ADD    $11, $ACC
  623:                  MOVE   $11, $ACC
  626:                  LOADI  $ACC, 92
  632:                  STORE  $ACC, ($11)
  635:                  MOVE   $ACC, $FP
  638:                  MOVE   $11, $ACC
  641:                  LOADI  $ACC, -2
  647:                  ADD    $11, $ACC
  650:                  LOAD   $ACC, ($ACC)
  653:                  MOVE   $11, $ACC
  656:                  LOADI  $ACC, 0
  662:                  ADD    $11, $ACC
  665:                  MOVE   $11, $ACC
  668:                  LOADI  $ACC, 93
  674:                  STORE  $ACC, ($11)
  677:                  MOVE   $ACC, $FP
  680:                  MOVE   $11, $ACC
  683:                  LOADI  $ACC, -2
  689:                  ADD    $11, $ACC
  692:                  LOAD   $ACC, ($ACC)
  695:                  MOVE   $11, $ACC
  698:                  LOADI  $ACC, 1
  704:                  ADD    $11, $ACC
  707:                  MOVE   $11, $ACC
  710:                  LOADI  $ACC, 94
  716:                  STORE  $ACC, ($11)
  719:                  LOADI  $ACC, 1
  725:                  SUB    $SP, $ACC
  728:                  MOVE   $SP, $ACC
  731:                  STORE  $tmp.t, ($SP)
  734:                  LOADI  $ACC, 1
  740:                  SUB    $SP, $ACC
  743:                  MOVE   $SP, $ACC
  746:                  STORE  $tmp.l, ($SP)
  749:                  MOVE   $ACC, $FP
  752:                  MOVE   $11, $ACC
  755:                  LOADI  $ACC, -1
  761:                  ADD    $11, $ACC
  764:                  LOAD   $ACC, ($ACC)
  767:                  MOVE   $11, $ACC
  770:                  LOADI  $ACC, 2
  776:                  ADD    $11, $ACC
  779:                  LOAD   $ACC, ($ACC)
  782:                  MOVE   $11, $ACC
  785:                  LOADI  $ACC, 1
  791:                  SUB    $SP, $ACC
  794:                  MOVE   $SP, $ACC
  797:                  STORE  $11, ($SP)
  800:                  LOADI  $ACC, _printint
  806:                  JMPAL  $ACC
  808:                  LOAD   $tmp.l, ($SP)
  811:                  LOADI  $ACC, 1
  817:                  ADD    $SP, $ACC
  820:                  MOVE   $SP, $ACC
  823:                  LOAD   $tmp.t, ($SP)
  826:                  LOADI  $ACC, 1
  832:                  ADD    $SP, $ACC
  835:                  MOVE   $SP, $ACC
  838:                  MOVE   $ACC, $RV
  841:                  LOADI  $ACC, 1
  847:                  SUB    $SP, $ACC
  850:                  MOVE   $SP, $ACC
  853:                  STORE  $tmp.t, ($SP)
  856:                  LOADI  $ACC, 1
  862:                  SUB    $SP, $ACC
  865:                  MOVE   $SP, $ACC
  868:                  STORE  $tmp.l, ($SP)
  871:                  LOADI  $ACC, 32
  877:                  MOVE   $11, $ACC
  880:                  LOADI  $ACC, 1
  886:                  SUB    $SP, $ACC
  889:                  MOVE   $SP, $ACC
  892:                  STORE  $11, ($SP)
  895:                  LOADI  $ACC, _printchar
  901:                  JMPAL  $ACC
  903:                  LOAD   $tmp.l, ($SP)
  906:                  LOADI  $ACC, 1
  912:                  ADD    $SP, $ACC
  915:                  MOVE   $SP, $ACC
  918:                  LOAD   $tmp.t, ($SP)
  921:                  LOADI  $ACC, 1
  927:                  ADD    $SP, $ACC
  930:                  MOVE   $SP, $ACC
  933:                  MOVE   $ACC, $RV
  936:                  LOADI  $ACC, 1
  942:                  SUB    $SP, $ACC
  945:                  MOVE   $SP, $ACC
  948:                  STORE  $tmp.t, ($SP)
  951:                  LOADI  $ACC, 1
  957:                  SUB    $SP, $ACC
  960:                  MOVE   $SP, $ACC
  963:                  STORE  $tmp.l, ($SP)
  966:                  MOVE   $ACC, $FP
  969:                  MOVE   $11, $ACC
  972:                  LOADI  $ACC, -2
  978:                  ADD    $11, $ACC
  981:                  LOAD   $ACC, ($ACC)
  984:                  MOVE   $11, $ACC
  987:                  LOADI  $ACC, 0
  993:                  ADD    $11, $ACC
  996:                  LOAD   $ACC, ($ACC)
  999:                  MOVE   $11, $ACC
 1002:                  LOADI  $ACC, 1
 1008:                  SUB    $SP, $ACC
 1011:                  MOVE   $SP, $ACC
 1014:                  STORE  $11, ($SP)
 1017:                  LOADI  $ACC, _printint
 1023:                  JMPAL  $ACC
 1025:                  LOAD   $tmp.l, ($SP)
 1028:                  LOADI  $ACC, 1
 1034:                  ADD    $SP, $ACC
 1037:                  MOVE   $SP, $ACC
 1040:                  LOAD   $tmp.t, ($SP)
 1043:                  LOADI  $ACC, 1
 1049:                  ADD    $SP, $ACC
 1052:                  MOVE   $SP, $ACC
 1055:                  MOVE   $ACC, $RV
 1058:                  LOADI  $ACC, 1
 1064:                  SUB    $SP, $ACC
 1067:                  MOVE   $SP, $ACC
 1070:                  STORE  $tmp.t, ($SP)
 1073:                  LOADI  $ACC, 1
 1079:                  SUB    $SP, $ACC
 1082:                  MOVE   $SP, $ACC
 1085:                  STORE  $tmp.l, ($SP)
 1088:                  LOADI  $ACC, 13
 1094:                  MOVE   $11, $ACC
 1097:                  LOADI  $ACC, 1
 1103:                  SUB    $SP, $ACC
 1106:                  MOVE   $SP, $ACC
 1109:                  STORE  $11, ($SP)
 1112:                  LOADI  $ACC, _printchar
 1118:                  JMPAL  $ACC
 1120:                  LOAD   $tmp.l, ($SP)
 1123:                  LOADI  $ACC, 1
 1129:                  ADD    $SP, $ACC
 1132:                  MOVE   $SP, $ACC
 1135:                  LOAD   $tmp.t, ($SP)
 1138:                  LOADI  $ACC, 1
 1144:                  ADD    $SP, $ACC
 1147:                  MOVE   $SP, $ACC
 1150:                  MOVE   $ACC, $RV
 1153:                  LOADI  $ACC, 1
 1159:                  SUB    $SP, $ACC
 1162:                  MOVE   $SP, $ACC
 1165:                  STORE  $tmp.t, ($SP)
 1168:                  LOADI  $ACC, 1
 1174:                  SUB    $SP, $ACC
 1177:                  MOVE   $SP, $ACC
 1180:                  STORE  $tmp.l, ($SP)
 1183:                  LOADI  $ACC, 10
 1189:                  MOVE   $11, $ACC
 1192:                  LOADI  $ACC, 1
 1198:                  SUB    $SP, $ACC
 1201:                  MOVE   $SP, $ACC
 1204:                  STORE  $11, ($SP)
 1207:                  LOADI  $ACC, _printchar
 1213:                  JMPAL  $ACC
 1215:                  LOAD   $tmp.l, ($SP)
 1218:                  LOADI  $ACC, 1
 1224:                  ADD    $SP, $ACC
 1227:                  MOVE   $SP, $ACC
 1230:                  LOAD   $tmp.t, ($SP)
 1233:                  LOADI  $ACC, 1
 1239:                  ADD    $SP, $ACC
 1242:                  MOVE   $SP, $ACC
 1245:                  MOVE   $ACC, $RV
 1248:                  LOADI  $ACC, 1
 1254:                  ADD    $FP, $ACC
 1257:                  LOAD   $RET, ($ACC)
 1260:                  LOAD   $FP, ($FP)
 1263:                  LOADI  $ACC, 4
 1269:                  ADD    $SP, $ACC
 1272:                  MOVE   $SP, $ACC
 1275:                  JMP    $RET
 1277:                  JMPI   _END
 1282:         _malloc: LOADI  $ACC, 1
 1288:                  SUB    $SP, $ACC
 1291:                  MOVE   $SP, $ACC
 1294:                  STORE  $RET, ($SP)
 1297:                  LOADI  $ACC, 1
 1303:                  SUB    $SP, $ACC
 1306:                  MOVE   $SP, $ACC
 1309:                  STORE  $FP, ($SP)
 1312:                  MOVE   $FP, $SP
 1315:                  LOADI  $ACC, 0
 1321:                  SUB    $SP, $ACC
 1324:                  MOVE   $SP, $ACC
 1327:                  LOADI  $9, 0
 1333:                  LOADI  $ACC, 2
 1339:                  ADD    $FP, $ACC
 1342:                  LOAD   $10, ($ACC)
 1345:                  LE     $9, $10
 1348:                  CJMPI  _malloc.sizeok
 1353:                  LOADI  $ACC, 1
 1359:                  ADD    $ACC, $SP
 1362:                  MOVE   $SP, $ACC
 1365:                  LOADI  $ACC, _malloc.errmsg
 1371:                  STORE  $ACC, ($SP)
 1374:                  JMPALI _printstr
 1379:                  JMPI   _END
 1384:  _malloc.sizeok: MOVE   $11, $MEMHI
 1387:                  ADD    $MEMHI, $10
 1390:                  MOVE   $MEMHI, $ACC
 1393:                  MOVE   $RV, $11
 1396:                  LOADI  $ACC, 1
 1402:                  ADD    $FP, $ACC
 1405:                  LOAD   $RET, ($ACC)
 1408:                  LOAD   $FP, ($FP)
 1411:                  LOADI  $ACC, 3
 1417:                  ADD    $SP, $ACC
 1420:                  MOVE   $SP, $ACC
 1423:                  JMP    $RET
 1425:       _printint: LOADI  $ACC, 1
 1431:                  SUB    $SP, $ACC
 1434:                  MOVE   $SP, $ACC
 1437:                  STORE  $RET, ($SP)
 1440:                  LOADI  $ACC, 1
 1446:                  SUB    $SP, $ACC
 1449:                  MOVE   $SP, $ACC
 1452:                  STORE  $FP, ($SP)
 1455:                  MOVE   $FP, $SP
 1458:                  LOADI  $ACC, 0
 1464:                  SUB    $SP, $ACC
 1467:                  MOVE   $SP, $ACC
 1470:                  LOADI  $ACC, 2
 1476:                  ADD    $FP, $ACC
 1479:                  LOAD   $9, ($ACC)
 1482:                  LOADI  $ACC, 0
 1488:                  MOVE   $OUT, $9
 1491:                  LOADI  $ACC, 1
 1497:                  ADD    $FP, $ACC
 1500:                  LOAD   $RET, ($ACC)
 1503:                  LOAD   $FP, ($FP)
 1506:                  LOADI  $ACC, 3
 1512:                  ADD    $SP, $ACC
 1515:                  MOVE   $SP, $ACC
 1518:                  JMP    $RET
 1520:      _printchar: LOADI  $ACC, 1
 1526:                  SUB    $SP, $ACC
 1529:                  MOVE   $SP, $ACC
 1532:                  STORE  $RET, ($SP)
 1535:                  LOADI  $ACC, 1
 1541:                  SUB    $SP, $ACC
 1544:                  MOVE   $SP, $ACC
 1547:                  STORE  $FP, ($SP)
 1550:                  MOVE   $FP, $SP
 1553:                  LOADI  $ACC, 0
 1559:                  SUB    $SP, $ACC
 1562:                  MOVE   $SP, $ACC
 1565:                  LOADI  $ACC, 2
 1571:                  ADD    $FP, $ACC
 1574:                  LOAD   $9, ($ACC)
 1577:                  LOADI  $ACC, 1
 1583:                  MOVE   $OUT, $9
 1586:                  LOADI  $ACC, 1
 1592:                  ADD    $FP, $ACC
 1595:                  LOAD   $RET, ($ACC)
 1598:                  LOAD   $FP, ($FP)
 1601:                  LOADI  $ACC, 3
 1607:                  ADD    $SP, $ACC
 1610:                  MOVE   $SP, $ACC
 1613:                  JMP    $RET
 1615:            _END: 
